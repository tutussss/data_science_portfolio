<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:pls="http://www.w3.org/2005/01/pronunciation-lexicon" xmlns:ssml="http://www.w3.org/2001/10/synthesis" xmlns:svg="http://www.w3.org/2000/svg">
<head>
  <meta charset="UTF-8" />
  <title>How to do it&#x2026;</title>
  <link type="text/css" rel="stylesheet" media="all" href="style.css" />
  <link type="text/css" rel="stylesheet" media="all" href="core.css" />
</head>
<body>
  <div id="sbo-rt-content"><section>

    <header>

      <h1 class="header-title">How to do itâ€¦</h1>

    </header>

    <article>

      <ol>

        <li>Let's create an S3 bucket for our data. Go to <span class="packt_screen">S3</span> and click on <span class="packt_screen">Create new bucket</span>. Type the name <kbd>cookbook-spectrum</kbd>.</li>

        <li>Now, we can unload data into this bucket and run this command, as shown in the following code block:</li>

      </ol>

      <pre style="padding-left: 60px;">unload ('select * from lineorder')<br/>to 's3://cookbook-spectrum/<br/>iam_role 'arn:aws:iam::615381814665:role/RedshiftS3Access'<br/>delimiter '\t'</pre>

      <ol start="3">

        <li>Let's create the external schema, as follows:</li>

      </ol>

      <pre style="padding-left: 60px;">create external schema datalake <br/>from data catalog <br/>database 'spectrumdb' <br/>iam_role 'arn:aws:iam::615381814665:role/RedshiftS3Access'<br/>create external database if not exists;</pre>

      <p class="mce-root"></p>

      <p class="mce-root"></p>

      <p class="mce-root"></p>

      <p class="mceNonEditable"></p>

      <ol start="4">

        <li>Let's create an external table in this schema<span>, as follows</span>:</li>

      </ol>

      <pre style="padding-left: 60px;">create external table datalake.lineorder<br/>(<br/>  lo_orderkey INTEGER <br/>  ,lo_linenumber INTEGER<br/>  ,lo_custkey INTEGER<br/>  ,lo_partkey INTEGER<br/>  ,lo_suppkey INTEGER<br/>  ,lo_orderdate INTEGER<br/>  ,lo_orderpriority VARCHAR(15)<br/>  ,lo_shippriority VARCHAR(1)<br/>  ,lo_quantity INTEGER <br/>  ,lo_extendedprice INTEGER<br/>  ,lo_ordertotalprice INTEGER <br/>  ,lo_discount INTEGER <br/>  ,lo_revenue INTEGER<br/>  ,lo_supplycost INTEGER <br/>  ,lo_tax INTEGER <br/>  ,lo_commitdate INTEGER<br/>  ,lo_shipmode VARCHAR(10)<br/>)<br/>row format delimited<br/>fields terminated by '\t'<br/>stored as textfile<br/>location 's3://cookbook-spectrum/<br/>table properties ('numRows'='172000');</pre>

      <ol start="5">

        <li>We can test this table by running queries against it, such as <kbd>SELECT * FROM datalake.lineorder</kbd>, or we can adjust our Tableau Data Source and use a Spectrum table instead of the initial one. However, it is better to tune the external table before use, otherwise Spectrum will scan the full table.</li>

      </ol>

      <p class="mce-root"></p>

    </article>

  </section>

</div>
</body>
</html>