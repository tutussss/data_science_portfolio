<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:pls="http://www.w3.org/2005/01/pronunciation-lexicon" xmlns:ssml="http://www.w3.org/2001/10/synthesis" xmlns:svg="http://www.w3.org/2000/svg">
<head>
  <meta charset="UTF-8" />
  <title>How to do it&#x2026;</title>
  <link type="text/css" rel="stylesheet" media="all" href="style.css" />
  <link type="text/css" rel="stylesheet" media="all" href="core.css" />
</head>
<body>
  <div id="sbo-rt-content"><section>

    <header>

      <h1 class="header-title">How to do itâ€¦</h1>

    </header>

    <article>

      <ol>

        <li>We can create a new data source and specify the following options:
<ul>
<li><span class="packt_screen">Warehouse</span>: <kbd>COMPUTE_WH</kbd></li>
<li><span class="packt_screen">Database</span>: <kbd>SNOWFLAKE_SAMPLE_DATA</kbd></li>
<li><span class="packt_screen">Schema</span>: <kbd>TPCH_SF1000</kbd></li>
</ul>
</li>

      </ol>

      <p style="padding-left: 60px;">You can learn more about the TPC sample dataset at <a href="http://www.tpc.org/tpc_documents_current_versions/pdf/tpc-ds_v2.5.0.pdf">http://www.tpc.org/tpc_documents_current_versions/pdf/tpc-ds_v2.5.0.pdf</a>.</p>

      <ol start="2">

        <li>When we are choosing <span class="packt_screen">Warehouse</span>, we are choosing to compute resources for our DW. In our case, <kbd>COMPUTE_WH</kbd> is a <kbd>X-Large</kbd>. We also have <kbd>SF_TUTS_WH</kbd> that is <kbd>X-Small</kbd>.</li>

        <li>Build the data model, as shown in the following screenshot:</li>

      </ol>

      <p class="CDPAlignCenter CDPAlign">

        <img class="aligncenter size-full wp-image-1927 image-border" src="images/cd028077-e551-40f7-95da-04569462c395.png" style="width:69.75em;height:16.00em;" />

      </p>

      <ol start="4">

        <li>Let's answer the following business question: List the totals for the extended price, discounted extended price plus tax, average quantity, average discount, and average extended price, and group the result by <span class="packt_screen">Return Flag</span> and <span class="packt_screen">Line Status</span>. Using Tableau, we can drag and drop the following object. Do not forget to pause Auto Updates. In addition, we should create the following calculation fields:
<ul>
<li><span class="packt_screen">Extended Discounted Price</span>: <kbd>[L Extendedprice]*(1-[L Discount])</kbd></li>
<li><span class="packt_screen">Extended Discounted Price with Tax</span>: <kbd>[L Extendedprice]*(1-[L Discount])*(1+[L Tax])</kbd></li>
</ul>
</li>

      </ol>

      <p style="padding-left: 60px;">Here is the screenshot showing the end result:</p>

      <p class="CDPAlignCenter CDPAlign">

        <img class="aligncenter size-full wp-image-1928 image-border" src="images/a63bddfb-20f1-4846-9a47-9e8921518780.png" style="width:113.67em;height:50.75em;" />

      </p>

      <p class="mce-root"></p>

      <ol start="5">

        <li>We can check with Snowflake GUI about the actual plan by going to <span class="packt_screen">History</span> and finding our <span class="packt_screen">Query</span>. Because we are using a live connection, Tableau generates a query and uses only one table, <kbd>LINEITEM</kbd>, instead of the whole data model, which saves us time and money.</li>

      </ol>

    </article>

  </section>

</div>
</body>
</html>